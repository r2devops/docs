---
sidebar_position: 1
id: controls
---

import SeverityBadge from '../../src/components/SeverityBadge';
import FixDurationBadge from '../../src/components/FixDurationBadge';

# Controls

R2Devops allows defining controls for GitLab projects, covering both CI/CD configuration and project settings. When a control is not respected, an issue is created.

## CI/CD Container Images
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| Containers images must come from authorized sources | <span style={{fontSize: '0.85em'}}>Verifies that container images used to run your CI/CD pipelines come from authorized and trusted sources.</span> | <span style={{fontSize: '0.85em'}}>Helps mitigate security risks introduced by the use of malicious, compromised, or vulnerable images.</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| Container images must not use forbidden tags | <span style={{fontSize: '0.85em'}}>Verifies that container images used to run your CI/CD pipelines rely on authorized tags.</span> | <span style={{fontSize: '0.85em'}}>Helps mitigate both security and functional risks introduced by the use of unverified, outdated, or compromised image versions.</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## CI/CD Variables
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| CI/CD variables must be protected | <span style={{fontSize: '0.85em'}}>Verifies that CI/CD variables used in a project have the protected field enabled.</span> | <span style={{fontSize: '0.85em'}}>Ensures sensitive values are restricted to protected branches or tags, reducing unauthorized exposure.</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| CI/CD variables must be masked | <span style={{fontSize: '0.85em'}}>Verifies that CI/CD variables used in a project have the masked field enabled.</span> | <span style={{fontSize: '0.85em'}}>Prevents variable values from being exposed in pipeline logs, reducing the risk of leaks.</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## CI/CD Secrets
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| Pipeline configuration must not contain secrets | <span style={{fontSize: '0.85em'}}>Uses Gitleaks to verify that both merged and unmerged CI/CD configurations don't have leaked secrets.</span> | <span style={{fontSize: '0.85em'}}>Prevents exposure of API keys, passwords, or tokens that could lead to unauthorized access.</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## Pipeline Composition
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| Pipelines must include templates | <span style={{fontSize: '0.85em'}}>Verifies that the projects contain specific templates. This control can also allow overriding certain variables in the included templates.</span> | <span style={{fontSize: '0.85em'}}>Ensures pipelines comply with required security and compliance practices.</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| Pipelines must include components | <span style={{fontSize: '0.85em'}}>Verifies that the projects contain specific GitLab components. This control can also allow overriding certain variables in the included components.</span> | <span style={{fontSize: '0.85em'}}>Ensures pipelines integrate mandatory security and compliance steps.</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| Pipeline must include required phases | <span style={{fontSize: '0.85em'}}>Verifies that the CI/CD pipeline includes a group of job types.</span> | <span style={{fontSize: '0.85em'}}>Ensures completeness and compliance of the pipeline execution flow.</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Long" info="1-2d" /> |
| Pipeline must not contain hardcoded jobs | <span style={{fontSize: '0.85em'}}>Verifies that no hardcoded job is used in CI/CD pipelines.</span> | <span style={{fontSize: '0.85em'}}>Improves maintainability and ensures compliance with best practices.</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| Pipeline must not use forbidden ref in includes | <span style={{fontSize: '0.85em'}}>Verifies that the included refs are using specified tags.</span> | <span style={{fontSize: '0.85em'}}>Prevents reliance on insecure or non-compliant references.</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| Pipeline must use only up-to-date includes | <span style={{fontSize: '0.85em'}}>Verifies that the included pipelines are up-to-date compared to their source.</span> | <span style={{fontSize: '0.85em'}}>Reduces risks from outdated or vulnerable templates.</span> | <SeverityBadge severity="Low" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## Access and Authorization
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| Branch must be protected | <span style={{fontSize: '0.85em'}}>Verifies that the project configuration respects the protection, push, merge and owner approval on included branch names.</span> | <span style={{fontSize: '0.85em'}}>Prevents unauthorized modifications and enforces branch protection standards.</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| MR approval rules must have at least N approval required | <span style={{fontSize: '0.85em'}}>Verifies that the project merge request approval rules that cover all protected branches have a minimum number of approval requirements.</span> | <span style={{fontSize: '0.85em'}}>Prevents unreviewed code from being merged, reducing security risks.</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| MR approval settings must be compliant | <span style={{fontSize: '0.85em'}}>Verifies that MR approval settings are properly configured.</span> | <span style={{fontSize: '0.85em'}}>Ensures compliance with review and security requirements.</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| An MR approval rule must be defined to cover all protected branches | <span style={{fontSize: '0.85em'}}>Verifies that the protected branches have at least one approval rule.</span> | <span style={{fontSize: '0.85em'}}>Ensures protected branches cannot bypass review processes.</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| Number of project members must respect a quota | <span style={{fontSize: '0.85em'}}>Verifies that the project configuration respects the owner, maintainer and developer quotas.</span> | <span style={{fontSize: '0.85em'}}>Prevents uncontrolled access that could weaken project security.</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| Number of group members must respect a quota | <span style={{fontSize: '0.85em'}}>Verifies that the group configuration respects the owner, maintainer and developer quotas.</span> | <span style={{fontSize: '0.85em'}}>Prevents uncontrolled access at group level, strengthening governance.</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| MR settings must be compliant | <span style={{fontSize: '0.85em'}}>Verifies that the project's merge request settings are correct in terms of merge method, resolving differences, squashing, etc.</span> | <span style={{fontSize: '0.85em'}}>Reduces risk of unauthorized or insecure code changes.</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## Other Controls
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| Project must have a security policy source | <span style={{fontSize: '0.85em'}}>Verifies if the projects have a specific project as their source of security policy.</span> | <span style={{fontSize: '0.85em'}}>Ensures compliance with security policy and reduces risk of unmanaged vulnerabilities.</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
