---
sidebar_position: 3.5
id: controls
---

import SeverityBadge from '../../src/components/SeverityBadge';
import FixDurationBadge from '../../src/components/FixDurationBadge';
import TooltipControl from '../../src/components/TooltipControl';
import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';
import { faQuestionCircle } from '@fortawesome/free-regular-svg-icons';


# R2Devops Controls

R2Devops performs various security and compliance checks on your GitLab projects. This document provides an overview of the controls R2Devops applies.


## Container Security
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <TooltipControl title="Images from unknown sources may contain malware or vulnerabilities"><span className="text-primary">Unknown image source</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>The origin of a container image you are using to run your CI/CD is unknown, posing a security risk.</span> | <span style={{fontSize: '0.85em'}}>Can introduce malicious code that steals API tokens, source code, or alters it</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <TooltipControl title="Images from untrusted sources pose significant security risks"><span className="text-primary">Untrusted image source</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>The origin of a container image you are using to run your CI/CD is not trusted, posing a security risk.</span> | <span style={{fontSize: '0.85em'}}>Can introduce malicious code that steals API tokens, source code, or alters it</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <TooltipControl title="Using mutable tags like 'latest' is discouraged"><span className="text-primary">Forbidden container image tag</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A container image used to run a CI/CD job is using a tag that is not recommended for security.</span> | <span style={{fontSize: '0.85em'}}>Can result in insecure containers or unexpected breaking changes</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## Secret Management
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <TooltipControl title="Variables without protection can be exposed"><span className="text-primary">Unprotected variable</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A variable can be used in CI/CD pipelines of all branches and tags, making its value exposed to all users in the project.</span> | <span style={{fontSize: '0.85em'}}>Unauthorized users can exploit variables, leading to security breaches</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <TooltipControl title="Variables should be masked to prevent exposure in logs"><span className="text-primary">Unmasked variable</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A CI/CD variable stored in a GitLab project or group is not masked, causing its value to be exposed in pipeline logs.</span> | <span style={{fontSize: '0.85em'}}>Exposed values can result in unauthorized access to sensitive data</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <TooltipControl title="Most critical variable protection issue"><span className="text-primary">Unmasked and unprotected variable</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A variable is both exposed in pipeline logs and allowed to be used on unprotected branches or tags.</span> | <span style={{fontSize: '0.85em'}}>Increases likelihood of sensitive data leakage and unauthorized access</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <TooltipControl title="Hardcoded secrets in pipeline configs"><span className="text-primary">Secret leak in pipeline configuration</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>Secret, such as API key or password, is hardcoded in the `.gitlab-ci.yml` file, making it visible to anyone with repository access.</span> | <span style={{fontSize: '0.85em'}}>Increases risk of unauthorized access, data leaks, and resource misuse</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## CI/CD Pipeline Configuration
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <TooltipControl title="Jobs should use templates instead of hardcoding"><span className="text-primary">Hardcoded job</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A job in the pipeline configuration is hardcoded, increasing maintainability costs and introducing a compliance risk.</span> | <span style={{fontSize: '0.85em'}}>Makes pipelines harder to maintain and risks non-compliance with standards</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <TooltipControl title="Overriding protected jobs is not allowed"><span className="text-primary">Forbidden override of job</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A CI/CD job coming from a template has been overridden in the project CI/CD configuration.</span> | <span style={{fontSize: '0.85em'}}>May cause inconsistent or insecure pipeline configurations</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <TooltipControl title="Templates should be kept up to date"><span className="text-primary">Outdated template</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>An outdated template is used in the project CI/CD pipeline configuration.</span> | <span style={{fontSize: '0.85em'}}>May have known vulnerabilities or lack compliance with current standards</span> | <SeverityBadge severity="Low" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <TooltipControl title="Some template versions may contain vulnerabilities"><span className="text-primary">Forbidden template version</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A CI/CD template in your pipeline is included using a version that is not recommended for security.</span> | <span style={{fontSize: '0.85em'}}>Can result in insecure templates or unexpected breaking changes</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <TooltipControl title="Required security templates must be included"><span className="text-primary">Missing required template</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A required CI/CD template for security compliance is missing in the project pipeline.</span> | <span style={{fontSize: '0.85em'}}>Results in non-compliant and insecure pipeline configurations</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <TooltipControl title="Required templates should not be modified"><span className="text-primary">Forbidden override of required template</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A required CI/CD template for security compliance has been overridden in the project pipeline.</span> | <span style={{fontSize: '0.85em'}}>Can lead to non-compliant and insecure pipelines</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <TooltipControl title="Global variables should not be overridden"><span className="text-primary">Forbidden override of global variable</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A variable defined globally in the project CI/CD configuration is considered a forbidden variable override for security compliance.</span> | <span style={{fontSize: '0.85em'}}>May result in inconsistent or insecure pipeline behavior</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <TooltipControl title="Pipeline configuration must follow composition rules"><span className="text-primary">Invalid pipeline composition</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>The project's CI pipeline does not include all the required actions for security compliance.</span> | <span style={{fontSize: '0.85em'}}>Can lead to unverified code being deployed, increasing security risks</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Long" info="1-2d" /> |
| <TooltipControl title="Projects should define composition requirements"><span className="text-primary">No pipeline composition requirement defined</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>There is no pipeline composition requirements defined for the project, which is required for security compliance.</span> | <span style={{fontSize: '0.85em'}}>Can result in insecure or incomplete pipeline setups</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <TooltipControl title="Required components must be included"><span className="text-primary">Missing required component</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A required GitLab catalog component for security compliance is missing in the project pipeline.</span> | <span style={{fontSize: '0.85em'}}>Results in non-compliant and insecure pipeline configurations</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <TooltipControl title="Required components should not be modified"><span className="text-primary">Forbidden override of required component</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A required GitLab catalog component for security compliance has been overridden in the project pipeline.</span> | <span style={{fontSize: '0.85em'}}>Can lead to non-compliant and insecure pipelines</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |

## Branch Protection
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <TooltipControl title="Critical branches should be protected"><span className="text-primary">Branch protection missing</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>A branch is not protected on the repository.</span> | <span style={{fontSize: '0.85em'}}>Highly vulnerable to unauthorized modifications</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <TooltipControl title="Protection settings must meet standards"><span className="text-primary">Branch protection configuration not compliant</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>The branch protection configuration does not meet the security requirements. The branch settings allow unauthorized access levels, force push capabilities, or bypass code owner approval requirements.</span> | <span style={{fontSize: '0.85em'}}>Can lead to unauthorized code changes, security vulnerabilities, and compliance issues</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## Merge Request Settings
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <TooltipControl title="MRs need sufficient approvals"><span className="text-primary">Merge request approval rule is below minimum</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>The merge request approval rule is configured with fewer approvers than the minimum required for security.</span> | <span style={{fontSize: '0.85em'}}>Can lead to unreviewed code being merged, increasing security risks</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <TooltipControl title="MR settings must meet standards"><span className="text-primary">Merge request approval settings are not compliant</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>The current merge request approval settings do not align with security requirements.</span> | <span style={{fontSize: '0.85em'}}>Can lead to unreviewed code being merged, increasing security risks</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <TooltipControl title="All protected branches need approval rules"><span className="text-primary">No merge request approval rule covering all protected branches</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>There is no merge request approval rule configured in the project that applies to all protected branches.</span> | <span style={{fontSize: '0.85em'}}>Increases likelihood of unauthorized or insecure changes being merged</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <TooltipControl title="General MR settings must meet standards"><span className="text-primary">Merge request settings are not compliant</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>The merge request settings in the project do not comply with security requirements, such as incorrect merge methods or merge options.</span> | <span style={{fontSize: '0.85em'}}>Can lead to unauthorized code changes and security vulnerabilities</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## Role Management
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <TooltipControl title="Project roles must follow quota policies"><span className="text-primary">Members' role quotas are not respected</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>The number of members assigned to specific roles in a GitLab project or group does not respect the recommended quotas for security.</span> | <span style={{fontSize: '0.85em'}}>Can lead to uncontrolled access to project resources, weakening security</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |

## Security Policy
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <TooltipControl title="Projects should define security policies"><span className="text-primary">Missing security policy source on project</span> <FontAwesomeIcon className='text-gray-secondary' icon={faQuestionCircle} /></TooltipControl> | <span style={{fontSize: '0.85em'}}>The project lacks the required security configuration source, violating compliance requirements.</span> | <span style={{fontSize: '0.85em'}}>Project may become non-compliant and vulnerable to risks</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
