---
sidebar_position: 3.5
id: controls
---

import SeverityBadge from '../../src/components/SeverityBadge';
import FixDurationBadge from '../../src/components/FixDurationBadge';

# Controls

R2Devops allows defining controls for GitLab projects, covering both CI/CD configuration and project settings. When a control is not respected, an issue is created.


## Container Security
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <span style={{textDecoration: 'underline'}}>Untrusted image source</span> | <span style={{fontSize: '0.85em'}}>The origin of a container image you are using to run your CI/CD is not trusted, posing a security risk.</span> | <span style={{fontSize: '0.85em'}}>Can introduce malicious code that steals API tokens, source code, or alters it</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <span style={{textDecoration: 'underline'}}>Unknown image source</span> | <span style={{fontSize: '0.85em'}}>The origin of a container image you are using to run your CI/CD is unknown, posing a security risk.</span> | <span style={{fontSize: '0.85em'}}>Can introduce malicious code that steals API tokens, source code, or alters it</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <span style={{textDecoration: 'underline'}}>Forbidden container image tag</span> | <span style={{fontSize: '0.85em'}}>A container image used to run a CI/CD job is using a tag that is not recommended for security.</span> | <span style={{fontSize: '0.85em'}}>Can result in insecure containers or unexpected breaking changes</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## Secret Management
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <span style={{textDecoration: 'underline'}}>Secret leak in pipeline configuration</span> | <span style={{fontSize: '0.85em'}}>Secret, such as API key or password, is hardcoded in the `.gitlab-ci.yml` file, making it visible to anyone with repository access.</span> | <span style={{fontSize: '0.85em'}}>Increases risk of unauthorized access, data leaks, and resource misuse</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <span style={{textDecoration: 'underline'}}>Unmasked and unprotected variable</span> | <span style={{fontSize: '0.85em'}}>A variable is both exposed in pipeline logs and allowed to be used on unprotected branches or tags.</span> | <span style={{fontSize: '0.85em'}}>Increases likelihood of sensitive data leakage and unauthorized access</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <span style={{textDecoration: 'underline'}}>Unprotected variable</span> | <span style={{fontSize: '0.85em'}}>A variable can be used in CI/CD pipelines of all branches and tags, making its value exposed to all users in the project.</span> | <span style={{fontSize: '0.85em'}}>Unauthorized users can exploit variables, leading to security breaches</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <span style={{textDecoration: 'underline'}}>Unmasked variable</span> | <span style={{fontSize: '0.85em'}}>A CI/CD variable stored in a GitLab project or group is not masked, causing its value to be exposed in pipeline logs.</span> | <span style={{fontSize: '0.85em'}}>Exposed values can result in unauthorized access to sensitive data</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## CI/CD Pipeline Configuration
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <span style={{textDecoration: 'underline'}}>Missing required template</span> | <span style={{fontSize: '0.85em'}}>A required CI/CD template for security compliance is missing in the project pipeline.</span> | <span style={{fontSize: '0.85em'}}>Results in non-compliant and insecure pipeline configurations</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <span style={{textDecoration: 'underline'}}>Forbidden override of required template</span> | <span style={{fontSize: '0.85em'}}>A required CI/CD template for security compliance has been overridden in the project pipeline.</span> | <span style={{fontSize: '0.85em'}}>Can lead to non-compliant and insecure pipelines</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <span style={{textDecoration: 'underline'}}>Invalid pipeline composition</span> | <span style={{fontSize: '0.85em'}}>The project's CI pipeline does not include all the required actions for security compliance.</span> | <span style={{fontSize: '0.85em'}}>Can lead to unverified code being deployed, increasing security risks</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Long" info="1-2d" /> |
| <span style={{textDecoration: 'underline'}}>No pipeline composition requirement defined</span> | <span style={{fontSize: '0.85em'}}>There is no pipeline composition requirements defined for the project, which is required for security compliance.</span> | <span style={{fontSize: '0.85em'}}>Can result in insecure or incomplete pipeline setups</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <span style={{textDecoration: 'underline'}}>Missing required component</span> | <span style={{fontSize: '0.85em'}}>A required GitLab catalog component for security compliance is missing in the project pipeline.</span> | <span style={{fontSize: '0.85em'}}>Results in non-compliant and insecure pipeline configurations</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <span style={{textDecoration: 'underline'}}>Forbidden override of required component</span> | <span style={{fontSize: '0.85em'}}>A required GitLab catalog component for security compliance has been overridden in the project pipeline.</span> | <span style={{fontSize: '0.85em'}}>Can lead to non-compliant and insecure pipelines</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <span style={{textDecoration: 'underline'}}>Hardcoded job</span> | <span style={{fontSize: '0.85em'}}>A job in the pipeline configuration is hardcoded, increasing maintainability costs and introducing a compliance risk.</span> | <span style={{fontSize: '0.85em'}}>Makes pipelines harder to maintain and risks non-compliance with standards</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <span style={{textDecoration: 'underline'}}>Forbidden override of job</span> | <span style={{fontSize: '0.85em'}}>A CI/CD job coming from a template has been overridden in the project CI/CD configuration.</span> | <span style={{fontSize: '0.85em'}}>May cause inconsistent or insecure pipeline configurations</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <span style={{textDecoration: 'underline'}}>Forbidden template version</span> | <span style={{fontSize: '0.85em'}}>A CI/CD template in your pipeline is included using a version that is not recommended for security.</span> | <span style={{fontSize: '0.85em'}}>Can result in insecure templates or unexpected breaking changes</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <span style={{textDecoration: 'underline'}}>Forbidden override of global variable</span> | <span style={{fontSize: '0.85em'}}>A variable defined globally in the project CI/CD configuration is considered a forbidden variable override for security compliance.</span> | <span style={{fontSize: '0.85em'}}>May result in inconsistent or insecure pipeline behavior</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |
| <span style={{textDecoration: 'underline'}}>Outdated template</span> | <span style={{fontSize: '0.85em'}}>An outdated template is used in the project CI/CD pipeline configuration.</span> | <span style={{fontSize: '0.85em'}}>May have known vulnerabilities or lack compliance with current standards</span> | <SeverityBadge severity="Low" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## Branch Protection
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <span style={{textDecoration: 'underline'}}>Branch protection missing</span> | <span style={{fontSize: '0.85em'}}>A branch is not protected on the repository.</span> | <span style={{fontSize: '0.85em'}}>Highly vulnerable to unauthorized modifications</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <span style={{textDecoration: 'underline'}}>Branch protection configuration not compliant</span> | <span style={{fontSize: '0.85em'}}>The branch protection configuration does not meet the security requirements. The branch settings allow unauthorized access levels, force push capabilities, or bypass code owner approval requirements.</span> | <span style={{fontSize: '0.85em'}}>Can lead to unauthorized code changes, security vulnerabilities, and compliance issues</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## Merge Request Settings
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <span style={{textDecoration: 'underline'}}>Merge request approval rule is below minimum</span> | <span style={{fontSize: '0.85em'}}>The merge request approval rule is configured with fewer approvers than the minimum required for security.</span> | <span style={{fontSize: '0.85em'}}>Can lead to unreviewed code being merged, increasing security risks</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <span style={{textDecoration: 'underline'}}>Merge request approval settings are not compliant</span> | <span style={{fontSize: '0.85em'}}>The current merge request approval settings do not align with security requirements.</span> | <span style={{fontSize: '0.85em'}}>Can lead to unreviewed code being merged, increasing security risks</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <span style={{textDecoration: 'underline'}}>No merge request approval rule covering all protected branches</span> | <span style={{fontSize: '0.85em'}}>There is no merge request approval rule configured in the project that applies to all protected branches.</span> | <span style={{fontSize: '0.85em'}}>Increases likelihood of unauthorized or insecure changes being merged</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
| <span style={{textDecoration: 'underline'}}>Merge request settings are not compliant</span> | <span style={{fontSize: '0.85em'}}>The merge request settings in the project do not comply with security requirements, such as incorrect merge methods or merge options.</span> | <span style={{fontSize: '0.85em'}}>Can lead to unauthorized code changes and security vulnerabilities</span> | <SeverityBadge severity="Medium" /> | <FixDurationBadge duration="Quick" info="<1h" /> |

## Role Management
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <span style={{textDecoration: 'underline'}}>Members' role quotas are not respected</span> | <span style={{fontSize: '0.85em'}}>The number of members assigned to specific roles in a GitLab project or group does not respect the recommended quotas for security.</span> | <span style={{fontSize: '0.85em'}}>Can lead to uncontrolled access to project resources, weakening security</span> | <SeverityBadge severity="High" /> | <FixDurationBadge duration="Medium" info="1-4h" /> |

## Security Policy
| Control | Problem | Impact | Severity | Fix Duration |
|---------|---------|--------|----------|--------------|
| <span style={{textDecoration: 'underline'}}>Missing security policy source on project</span> | <span style={{fontSize: '0.85em'}}>The project lacks the required security configuration source, violating compliance requirements.</span> | <span style={{fontSize: '0.85em'}}>Project may become non-compliant and vulnerable to risks</span> | <SeverityBadge severity="Critical" /> | <FixDurationBadge duration="Quick" info="<1h" /> |
